<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Competition List</title>
    
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>

    <div id="app">
        
        <h1>ML Competition List</h1>
        
        <p v-if="loading">Chargement des données...</p>
        <p v-if="error" style="color: red;">Erreur: {{ error }}</p>
        
        <div class="filter-controls" v-if="!loading">
            
            <input 
                type="text" 
                v-model="searchQuery" 
                placeholder="Rechercher par nom..." 
                class="search-bar"
            >
            
            <div class="quick-filters">
                <div class="toggle-container">
                    <input type="checkbox" v-model="hideEnded" id="hide-ended-toggle">
                    <label for="hide-ended-toggle">Masquer les terminés</label>
                </div>
                <div class="toggle-container">
                    <input type="checkbox" v-model="filterHasPrize" id="has-prize-toggle">
                    <label for="has-prize-toggle">Afficher uniquement avec prix</label>
                </div>
                <div class="toggle-container">
                    <input type="checkbox" v-model="filterIsNew" id="is-new-toggle">
                    <label for="is-new-toggle">Afficher uniquement les nouveaux</label>
                </div>
                <div class="toggle-container">
                    <input type="checkbox" v-model="filterIsRecent" id="is-recent-toggle">
                    <label for="is-recent-toggle">Afficher uniquement les récents</label>
                </div>
                <div class="toggle-container">
                    <input type="checkbox" v-model="filterIsUpcoming" id="is-upcoming-toggle">
                    <label for="is-upcoming-toggle">Afficher uniquement à venir</label>
                </div>
                <div class="sort-container">
                    <label for="sort-select">Trier par :</label>
                    <select id="sort-select" v-model="sortBy">
                        <option value="deadline-asc">Date de fin (la plus proche)</option>
                        <option value="name-asc">Nom (A-Z)</option>
                        <option value="launched-desc">Date de début (la plus récente)</option>
                    </select>
                </div>
            </div>

            <details class="collapsible-filter">
                <summary>Filtrer par Source ({{ selectedSources.length }} / {{ availableSources.length }})</summary>
                <div class="filter-container">
                    <div class="source-checkbox-item" v-for="source in availableSources" :key="source">
                        <input 
                            type="checkbox" 
                            :id="'source-' + source" 
                            :value="source" 
                            v-model="selectedSources"
                        >
                        <label :for="'source-' + source">{{ source }}</label>
                    </div>
                </div>
            </details>
            
            <details class="collapsible-filter">
                <summary>Filtrer par Tags ({{ selectedTags.length }} cochés)</summary>
                
                <input 
                    type="text" 
                    v-model="tagSearchQuery" 
                    placeholder="Rechercher un tag..." 
                    class="tag-search-bar"
                >
                
                <div class="filter-container">
                    <div class="tag-checkbox-item" v-for="tag in filteredTags" :key="tag">
                        <input 
                            type="checkbox" 
                            :id="'tag-' + tag" 
                            :value="tag" 
                            v-model="selectedTags"
                        >
                        <label :for="'tag-' + tag">{{ tag }}</label>
                    </div>
                </div>
            </details>

        </div>
        
        <div v-if="!loading && !error">
            
            <div v-for="competition in paginatedCompetitions" :key="competition.url" class="competition-card">
                
                <div class="badge-container">
                    <span v-if="competition.isNew" class="badge badge-new">Nouveau</span>
                    <span v-if="isRecent(competition.launched)" class="badge badge-recent">Récent</span>
                    <span v-if="isUpcoming(competition.launched)" class="badge badge-upcoming">À venir</span>
                </div>

                <h3>{{ competition.name }}</h3>
                
                <div class="deadline" :class="{ ended: isEnded(competition.deadline) }">
                    {{ getCompetitionStatus(competition) }}
                </div>
                <div class="details">
                    <p><strong>Début :</strong> {{ formatDisplayDate(competition.launched) }}</p>
                    <p><strong>Prix :</strong> {{ competition.prize }}</p>
                    <p><strong>Plateforme :</strong> {{ competition.platform }}</p>
                    <p><strong>Conférence :</strong> {{ competition.conference }} {{ competition.conference_year }}</p>
                </div>
                
                <div class="tags-container">
                    <span v-for="tag in competition.tags" :key="tag" class="tag">
                        {{ tag }}
                    </span>
                </div>
                
                <a :href="competition.url" target="blank" class="main-link">
                    Voir la compétition
                </a>
            </div>
            
            <p v-if="sortedAndFilteredCompetitions.length === 0">
                Aucune compétition ne correspond à vos filtres.
            </p>
            
            <div class="pagination-controls" v-if="totalPages > 1">
                <button @click="prevPage" :disabled="currentPage === 1">
                    Précédent
                </button>
                <span>Page {{ currentPage }} sur {{ totalPages }}</span>
                <button @click="nextPage" :disabled="currentPage === totalPages">
                    Suivant
                </button>
            </div>
            
        </div>
        
    </div> <script src="script.js" defer></script>
</body>
</html>